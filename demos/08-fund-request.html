<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì—‘ì…€ ë‹¤ì¤‘ì‹œíŠ¸ ë¬¸ì„œ ë·°ì–´Â·ì¸ì‡„ ì•±</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
:root{
  --excel-grid:#d0d0d0;
  --excel-header:#f3f5f7;
  --excel-text:#111;
  --excel-muted:#666;
  --excel-focus:#0d6efd;
  --cell-pad-y:4px;
  --cell-pad-x:6px;
  --cell-font: 12px;
}

@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');

html, body{ height:100%; }
body{
  font-family:"Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--excel-text);
  background:#fff;
}

.app-title{ font-weight:700; letter-spacing:-0.2px; }

.sheet-tabs{ gap:.25rem; flex-wrap:wrap; }
.sheet-tab-btn{
  border:1px solid #dee2e6;
  background:#fff;
  border-radius:.5rem;
  padding:.35rem .6rem;
  font-size:.95rem;
}
.sheet-tab-btn[aria-selected="true"]{
  border-color:rgba(13,110,253,.35);
  box-shadow:0 0 0 .2rem rgba(13,110,253,.15);
}

.viewer-shell{
  border:1px solid #e5e7eb;
  border-radius:12px;
  overflow:hidden;
}

.viewer-toolbar{
  background:#fff;
  border-bottom:1px solid #e9ecef;
}

.sheet-meta{
  color:var(--excel-muted);
  font-size:.9rem;
}

/* Excel-like table */
.excel-wrap{ overflow:auto; max-height: calc(100vh - 230px); background:#fff; }
.excel-table{
  border-collapse:collapse;
  table-layout:fixed;
  width:max-content;
  min-width:100%;
  font-size:var(--cell-font);
}
.excel-table caption{ caption-side:top; text-align:left; padding:.5rem .75rem; font-weight:600; }
.excel-table th,
.excel-table td{
  border:1px solid var(--excel-grid);
  padding:var(--cell-pad-y) var(--cell-pad-x);
  vertical-align:middle;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  background:#fff;
}
.excel-table th{
  background:var(--excel-header);
  font-weight:600;
}

/* Sticky headers (optional) */
.excel-table thead th{ position:sticky; top:0; z-index:3; }
.excel-table .row-header{ position:sticky; left:0; z-index:2; background:var(--excel-header); }
.excel-table thead .corner{ left:0; z-index:4; }

.cell-wrap{ white-space:normal; }
.cell-right{ text-align:right; }
.cell-center{ text-align:center; }
.cell-left{ text-align:left; }

/* Print */
@page{ size: A4 landscape; margin: 25mm 10mm; }

@media print{
  .no-print{ display:none !important; }
  body{ background:#fff !important; }
  .container{ max-width:none !important; }
  .viewer-shell{ border:none !important; border-radius:0 !important; }
  .excel-wrap{ overflow:visible !important; max-height:none !important; }
  .excel-table{ width:100% !important; min-width:0 !important; }
  .excel-table thead th{ position:static !important; }
  .excel-table .row-header{ position:static !important; }
  tr{ page-break-inside:avoid; break-inside:avoid; }
}

/* A11y focus */
button:focus-visible, .sheet-tab-btn:focus-visible{
  outline:3px solid rgba(13,110,253,.35);
  outline-offset:2px;
}

.mono{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
  </style>
</head>
<body>
  <div class="container py-4" x-data="appData()" x-init="init()">

    <header class="d-flex flex-column gap-3 mb-3 no-print">
      <div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
        <div>
          <h1 class="h4 mb-1 app-title">ì—‘ì…€ ë‹¤ì¤‘ì‹œíŠ¸ ë¬¸ì„œ ë·°ì–´Â·ì¸ì‡„ ì•±</h1>
          <div class="text-secondary small">ìˆ˜ì‹/ì…ë ¥ ì…€ ë¯¸í™•ì • ìƒíƒœì˜ ë¬¸ì„œë¥¼ ì‹œíŠ¸ë³„ë¡œ í‘œì‹œí•˜ê³  ì¸ì‡„(A4 ê°€ë¡œ)ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</div>
        </div>
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-outline-primary" @click="printActiveSheet()" :disabled="!activeSheetName">
            ì¸ì‡„
          </button>
          <button type="button" class="btn btn-primary" @click="exportActiveSheetToPdf()" :disabled="!activeSheetName">
            PDF ì €ì¥
          </button>
        </div>
      </div>

      <nav aria-label="ì‹œíŠ¸ ì„ íƒ" class="viewer-toolbar p-2 rounded-3 border">
        <div class="d-flex align-items-center justify-content-between gap-2 flex-wrap">
          <div role="tablist" aria-label="ì‹œíŠ¸ íƒ­" class="d-flex sheet-tabs">
            <template x-for="name in sheetNames" :key="name">
              <button
                type="button"
                class="sheet-tab-btn"
                role="tab"
                :id="'tab-' + name"
                :aria-selected="String(activeSheetName === name)"
                :aria-controls="'panel-' + name"
                @click="setActiveSheet(name)"
                @keydown.enter.prevent="setActiveSheet(name)"
                @keydown.space.prevent="setActiveSheet(name)"
              >
                <span x-text="name"></span>
              </button>
            </template>
          </div>

          <div class="sheet-meta" x-show="activeSheetName" x-transition>
            <span class="me-2">í™œì„± ì‹œíŠ¸:</span>
            <strong x-text="activeSheetName"></strong>
            <span class="mx-2">|</span>
            <span x-text="activeSheetInfo"></span>
          </div>
        </div>
      </nav>
    </header>

    <div class="viewer-shell">
      <main class="p-0" :aria-busy="loading ? 'true' : 'false'">
        <section
          class="excel-wrap"
          :id="activeSheetName ? ('panel-' + activeSheetName) : 'panel-none'"
          role="tabpanel"
          :aria-labelledby="activeSheetName ? ('tab-' + activeSheetName) : null"
          tabindex="0"
        >
          <div class="p-3" x-show="loading" x-transition>
            <div class="d-flex align-items-center gap-2">
              <div class="spinner-border" role="status" aria-label="ë¡œë”© ì¤‘"></div>
              <div>
                <div class="fw-semibold">ë¬¸ì„œ ë¡œë”© ì¤‘â€¦</div>
                <div class="text-secondary small">(í˜„ì¬ëŠ” ìƒ˜í”Œ JSON ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‹¤ì œ ì—‘ì…€ íŒŒì‹± ê²°ê³¼ JSONìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.)</div>
              </div>
            </div>
          </div>

          <div class="p-3" x-show="!loading && !activeSheetName" x-transition>
            <div class="alert alert-warning mb-0" role="alert">
              í‘œì‹œí•  ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤. ìƒë‹¨ íƒ­ì´ ë³´ì´ì§€ ì•Šìœ¼ë©´ JSON ëª¨ë¸ì— sheetsê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
            </div>
          </div>

          <div id="sheetContainer" x-show="!loading && activeSheetName" x-transition class="p-0"></div>
        </section>
      </main>
    </div>

    <footer class="mt-3 text-secondary small no-print">
      <div>íŒ: ì‹¤ì œ ìš´ì˜ì—ì„œëŠ” ì„œë²„(ê¶Œì¥: Node + exceljs/xlsx)ì—ì„œ ì‹œíŠ¸ usedRange(A1:AM ë“±) ì…€ ê°’/ì„œì‹/ë³‘í•©ì„ JSONìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ <span class="mono">loadWorkbookModel()</span>ì— ì „ë‹¬í•˜ì„¸ìš”.</div>
    </footer>

  </div>

  <script>
/* =========================
   Excel formula helper functions (included for future expansion)
   ========================= */
function _sum(...args) {
    return args.flat().reduce((a, b) => (parseFloat(a) || 0) + (parseFloat(b) || 0), 0);
}

function _sumRange(rangeData) {
    if (Array.isArray(rangeData)) {
        return rangeData.flat().reduce((a, b) => (parseFloat(a) || 0) + (parseFloat(b) || 0), 0);
    }
    return parseFloat(rangeData) || 0;
}

function _average(...args) {
    const flat = args.flat().filter(x => x !== null && x !== '' && !isNaN(x));
    return flat.length ? _sum(...flat) / flat.length : 0;
}

function _averageRange(rangeData) {
    if (Array.isArray(rangeData)) {
        const flat = rangeData.flat().filter(x => x !== null && x !== '' && !isNaN(x));
        return flat.length ? _sumRange(flat) / flat.length : 0;
    }
    return parseFloat(rangeData) || 0;
}

function _count(...args) {
    return args.flat().filter(x => typeof x === 'number' && !isNaN(x)).length;
}

function _counta(...args) {
    return args.flat().filter(x => x !== null && x !== '' && x !== undefined).length;
}

function _and(...args) {
    return args.every(x => Boolean(x));
}

function _or(...args) {
    return args.some(x => Boolean(x));
}

function _round(num, digits = 0) {
    const factor = Math.pow(10, digits);
    return Math.round(num * factor) / factor;
}

function _roundUp(num, digits = 0) {
    const factor = Math.pow(10, digits);
    return Math.ceil(num * factor) / factor;
}

function _roundDown(num, digits = 0) {
    const factor = Math.pow(10, digits);
    return Math.floor(num * factor) / factor;
}

function _len(text) {
    return String(text).length;
}

function _left(text, numChars = 1) {
    return String(text).substring(0, numChars);
}

function _right(text, numChars = 1) {
    const str = String(text);
    return str.substring(str.length - numChars);
}

function _mid(text, startNum, numChars) {
    return String(text).substring(startNum - 1, startNum - 1 + numChars);
}

function _trim(text) {
    return String(text).trim();
}

function _upper(text) {
    return String(text).toUpperCase();
}

function _lower(text) {
    return String(text).toLowerCase();
}

function _concat(...args) {
    return args.join('');
}

// Number formatting
function formatNumber(num, decimals = 0) {
    return new Intl.NumberFormat('ko-KR', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
    }).format(num);
}

function formatCurrency(num) {
    return new Intl.NumberFormat('ko-KR', {
        style: 'currency',
        currency: 'KRW',
        maximumFractionDigits: 0
    }).format(num);
}

function formatPercent(num, decimals = 1) {
    return new Intl.NumberFormat('ko-KR', {
        style: 'percent',
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
    }).format(num / 100);
}

/* =========================
   Utilities
   ========================= */
const COLS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
function colToName(n){
  // 1-based
  let name='';
  while(n>0){
    const r=(n-1)%26;
    name=String.fromCharCode(65+r)+name;
    n=Math.floor((n-1)/26);
  }
  return name;
}

function safeText(v){
  if (v === null || v === undefined) return '';
  return String(v);
}

function parseA1(a1){
  const m = /^([A-Z]+)(\d+)$/.exec(a1.toUpperCase());
  if(!m) return null;
  const colStr=m[1];
  const row=parseInt(m[2],10);
  let col=0;
  for(const ch of colStr){ col = col*26 + (ch.charCodeAt(0)-64); }
  return {row, col};
}

function rangeToBounds(range){
  // "A1:AM58"
  const parts = range.split(':');
  const a = parseA1(parts[0]);
  const b = parseA1(parts[1] || parts[0]);
  if(!a||!b) return null;
  return {
    r1: Math.min(a.row,b.row),
    c1: Math.min(a.col,b.col),
    r2: Math.max(a.row,b.row),
    c2: Math.max(a.col,b.col)
  };
}

function mergeKey(r,c){ return r+','+c; }

/* =========================
   Core functions per plan
   ========================= */
function loadWorkbookModel(workbookJson){
  // Normalize model:
  // workbookModel = { sheets: { [name]: { name, usedRange, rows, cols, cells, merges, colWidths } } }
  const wb = { sheets: {} };
  if(!workbookJson || !workbookJson.sheets){
    return wb;
  }

  for(const sh of workbookJson.sheets){
    const usedRange = sh.usedRange || 'A1:A1';
    const b = rangeToBounds(usedRange) || {r1:1,c1:1,r2:1,c2:1};
    const rows = sh.rows || (b.r2 - b.r1 + 1);
    const cols = sh.cols || (b.c2 - b.c1 + 1);

    // cells: object keyed by A1 => { v, t, s }
    const cells = sh.cells || {};

    // merges: [{ s:'A1', e:'B2' }] or [{start:'A1', end:'B2'}]
    const mergesRaw = sh.merges || [];
    const merges = mergesRaw.map(m => ({
      s: (m.s || m.start || '').toUpperCase(),
      e: (m.e || m.end || '').toUpperCase()
    })).filter(m => m.s && m.e);

    wb.sheets[sh.name] = {
      name: sh.name,
      usedRange,
      bounds: b,
      rows,
      cols,
      cells,
      merges,
      colWidths: sh.colWidths || null,
      rowHeights: sh.rowHeights || null
    };
  }
  return wb;
}

function renderSheetTable(sheetModel, containerEl){
  if(!sheetModel || !containerEl) return;
  containerEl.innerHTML = '';

  const { bounds, rows, cols, cells, merges, colWidths, rowHeights } = sheetModel;

  // Build merge maps
  const mergeStartMap = new Map(); // key "r,c" -> {rowspan,colspan}
  const covered = new Set();

  for(const m of merges){
    const s = parseA1(m.s);
    const e = parseA1(m.e);
    if(!s || !e) continue;
    const r1 = Math.min(s.row, e.row);
    const r2 = Math.max(s.row, e.row);
    const c1 = Math.min(s.col, e.col);
    const c2 = Math.max(s.col, e.col);
    mergeStartMap.set(mergeKey(r1,c1), { rowspan:(r2-r1+1), colspan:(c2-c1+1) });
    for(let r=r1;r<=r2;r++){
      for(let c=c1;c<=c2;c++){
        if(r===r1 && c===c1) continue;
        covered.add(mergeKey(r,c));
      }
    }
  }

  const table = document.createElement('table');
  table.className = 'excel-table';
  table.setAttribute('role','table');

  const caption = document.createElement('caption');
  caption.textContent = sheetModel.name;
  table.appendChild(caption);

  // Colgroup for widths
  if(colWidths && Array.isArray(colWidths)){
    const colgroup = document.createElement('colgroup');
    // add row header col
    const colRh = document.createElement('col');
    colRh.style.width = '52px';
    colgroup.appendChild(colRh);
    for(let c=1;c<=cols;c++){
      const col = document.createElement('col');
      const w = colWidths[c-1];
      if(w) col.style.width = (typeof w === 'number' ? (w+'px') : String(w));
      colgroup.appendChild(col);
    }
    table.appendChild(colgroup);
  }

  const thead = document.createElement('thead');
  const trh = document.createElement('tr');
  const corner = document.createElement('th');
  corner.className = 'corner';
  corner.textContent = '';
  corner.setAttribute('scope','col');
  corner.style.minWidth = '52px';
  trh.appendChild(corner);

  for(let c=0;c<cols;c++){
    const th = document.createElement('th');
    th.setAttribute('scope','col');
    th.textContent = colToName(bounds.c1 + c);
    trh.appendChild(th);
  }
  thead.appendChild(trh);
  table.appendChild(thead);

  const tbody = document.createElement('tbody');

  for(let r=0;r<rows;r++){
    const tr = document.createElement('tr');
    if(rowHeights && rowHeights[r]) tr.style.height = (typeof rowHeights[r] === 'number' ? (rowHeights[r]+'px') : String(rowHeights[r]));

    const thRow = document.createElement('th');
    thRow.className = 'row-header';
    thRow.setAttribute('scope','row');
    thRow.textContent = String(bounds.r1 + r);
    tr.appendChild(thRow);

    for(let c=0;c<cols;c++){
      const rr = bounds.r1 + r;
      const cc = bounds.c1 + c;
      const k = mergeKey(rr,cc);
      if(covered.has(k)) continue;

      const td = document.createElement('td');
      const a1 = colToName(cc) + String(rr);
      td.dataset.a1 = a1;

      // Merge spans
      const ms = mergeStartMap.get(k);
      if(ms){
        td.rowSpan = ms.rowspan;
        td.colSpan = ms.colspan;
      }

      const cell = cells[a1] || null;
      const v = cell ? cell.v : '';
      td.textContent = safeText(v);

      // Apply minimal style mapping
      if(cell && cell.s){
        applyCellStyle(td, cell.s);
      }

      tr.appendChild(td);
    }

    tbody.appendChild(tr);
  }

  table.appendChild(tbody);
  containerEl.appendChild(table);
}

function applyCellStyle(td, s){
  // s can be: { font:{name,size,bold,italic,color}, fill:{fgColor}, alignment:{horizontal,vertical,wrapText}, border:{...}, numFmt }
  try{
    if(s.font){
      if(s.font.bold) td.style.fontWeight = '700';
      if(s.font.italic) td.style.fontStyle = 'italic';
      if(s.font.size) td.style.fontSize = s.font.size + 'px';
      if(s.font.name) td.style.fontFamily = s.font.name + ', "Noto Sans KR", sans-serif';
      if(s.font.color) td.style.color = normalizeColor(s.font.color);
    }
    if(s.fill && (s.fill.fgColor || s.fill.bgColor)){
      td.style.background = normalizeColor(s.fill.fgColor || s.fill.bgColor);
    }
    if(s.alignment){
      if(s.alignment.horizontal){
        const h = s.alignment.horizontal;
        if(h === 'right') td.classList.add('cell-right');
        else if(h === 'center') td.classList.add('cell-center');
        else td.classList.add('cell-left');
      }
      if(s.alignment.wrapText){
        td.style.whiteSpace = 'normal';
        td.style.wordBreak = 'break-word';
      }
      if(s.alignment.vertical){
        td.style.verticalAlign = s.alignment.vertical;
      }
    }
    if(s.border){
      // Basic: if any border present -> darker grid
      td.style.borderColor = '#b8b8b8';
    }
  } catch(e){
    // ignore style errors
  }
}

function normalizeColor(c){
  // Accept: "#RRGGBB", "RRGGBB", {argb:"FF112233"}
  if(!c) return '';
  if(typeof c === 'string'){
    const s=c.trim();
    if(s.startsWith('#')) return s;
    if(/^[0-9a-fA-F]{6}$/.test(s)) return '#'+s;
    if(/^[0-9a-fA-F]{8}$/.test(s)) return '#'+s.slice(2);
    return s;
  }
  if(typeof c === 'object' && c.argb){
    const a = String(c.argb);
    if(a.length === 8) return '#'+a.slice(2);
    if(a.length === 6) return '#'+a;
  }
  return '';
}

/* =========================
   App state (Alpine)
   ========================= */
function appData(){
  return {
    loading: true,
    workbookModel: { sheets: {} },
    activeSheetName: '',

    get sheetNames(){
      return Object.keys(this.workbookModel.sheets || {});
    },

    get activeSheet(){
      return this.activeSheetName ? this.workbookModel.sheets[this.activeSheetName] : null;
    },

    get activeSheetInfo(){
      const sh = this.activeSheet;
      if(!sh) return '';
      return `ì‚¬ìš©ë²”ìœ„ ${sh.usedRange} Â· ${sh.rows}í–‰ Ã— ${sh.cols}ì—´`;
    },

    init(){
      // Demo workbook JSON (replace with real parsed JSON)
      const demo = buildDemoWorkbookJson();
      this.workbookModel = loadWorkbookModel(demo);

      const first = this.sheetNames[0] || '';
      if(first) this.activeSheetName = first;

      this.$nextTick(() => {
        this.refreshRender();
        this.loading = false;
      });
    },

    refreshRender(){
      const container = document.getElementById('sheetContainer');
      if(!container) return;
      if(!this.activeSheet){
        container.innerHTML = '';
        return;
      }
      renderSheetTable(this.activeSheet, container);
    },

    setActiveSheet(sheetName){
      if(!sheetName || !this.workbookModel.sheets[sheetName]) return;
      this.activeSheetName = sheetName;
      this.$nextTick(() => this.refreshRender());
    },

    printActiveSheet(){
      // Print the current view; CSS @media print hides controls.
      // Ensure sheet is rendered before printing.
      this.$nextTick(() => {
        window.print();
      });
    },

    exportActiveSheetToPdf(){
      // No external deps allowed. Use browser "Save as PDF" via print.
      // Provide guidance and still trigger print dialog.
      alert('PDF ì €ì¥ì€ ë¸Œë¼ìš°ì € ì¸ì‡„ ê¸°ëŠ¥(ëŒ€ìƒ: "PDFë¡œ ì €ì¥")ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì¸ì‡„ ëŒ€í™”ìƒìì—ì„œ í”„ë¦°í„°ë¥¼ PDFë¡œ ì„ íƒí•˜ì„¸ìš”.');
      this.printActiveSheet();
    },

    calculate(inputs){
      // No-op for now (no formulas/inputs detected)
      return inputs;
    }
  };
}

/* =========================
   Demo data (to make the app work out-of-the-box)
   Replace this with real workbook JSON from server.
   ========================= */
function buildDemoWorkbookJson(){
  const sheetNames = [
    '20070327104129','Sheet1','Sheet2','Sheet3','Sheet4','Sheet5','Sheet6','Sheet7'
  ];

  // A1:AM is 39 cols (A=1 .. AM=39). Provide small row counts as placeholders.
  const cols = 39;

  function makeSheet(name, rows){
    const usedRange = `A1:${colToName(cols)}${rows}`;
    const cells = {};

    // Simple header-like rows
    cells['A1'] = { v: name + ' (ìƒ˜í”Œ ë Œë”ë§)', s:{ font:{ bold:true, size:14 }, alignment:{ horizontal:'left', wrapText:true } } };
    cells['A2'] = { v: 'â€» ì‹¤ì œ ì—‘ì…€ ë‚´ìš©/ì„œì‹/ë³‘í•©ì€ JSONìœ¼ë¡œ ì£¼ì…í•´ì•¼ ë™ì¼í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤.', s:{ font:{ size:12, color:'#555555' }, alignment:{ wrapText:true } } };
    cells['A4'] = { v: 'usedRange', s:{ font:{ bold:true }, fill:{ fgColor:'#F3F5F7' } } };
    cells['B4'] = { v: usedRange };
    cells['A5'] = { v: 'ì¸ì‡„', s:{ font:{ bold:true }, fill:{ fgColor:'#F3F5F7' } } };
    cells['B5'] = { v: 'A4 ê°€ë¡œ Â· ì—¬ë°± ìƒ/í•˜ 25mm, ì¢Œ/ìš° 10mm' };

    // Add a light grid of sample values
    for(let r=8;r<=Math.min(rows,18);r++){
      for(let c=1;c<=Math.min(cols,10);c++){
        const a1 = colToName(c)+r;
        cells[a1] = { v: `${colToName(c)}${r}` };
      }
    }

    // Demo merge
    const merges = [{ s:'A1', e:'D1' }, { s:'A2', e:'H3' }];

    return {
      name,
      usedRange,
      rows,
      cols,
      merges,
      // optional widths (approx excel feel)
      colWidths: [120,120,120,120,120,120,120,120,120,120, ...Array(cols-10).fill(90)],
      cells
    };
  }

  return {
    sheets: [
      makeSheet(sheetNames[0], 34),
      makeSheet(sheetNames[1], 58),
      makeSheet(sheetNames[2], 58),
      makeSheet(sheetNames[3], 58),
      makeSheet(sheetNames[4], 58),
      makeSheet(sheetNames[5], 58),
      makeSheet(sheetNames[6], 58),
      makeSheet(sheetNames[7], 58)
    ]
  };
}
  </script>

<!-- í•´ì»¤í†¤ ì„ ì • ì •ë³´ -->
<div id="selection-banner" style="
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 12px 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    font-size: 14px;
    z-index: 10000;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
">
    <div>
        <strong>ğŸ“Š ìê¸ˆì§‘í–‰í’ˆì˜ì„œ</strong>
        <span style="margin-left: 10px; opacity: 0.9;">| ì¬ë¬´/ìê¸ˆ</span>
    </div>
    <div style="display: flex; align-items: center; gap: 15px;">
        <span style="background: rgba(255,255,255,0.2); padding: 4px 10px; border-radius: 12px; font-size: 12px;">
            0ê°œ ìˆ˜ì‹
        </span>
        <button onclick="document.getElementById('selection-info').style.display='block'"
                style="background: white; color: #667eea; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-weight: 500;">
            ì„ ì • ì´ìœ  ë³´ê¸°
        </button>
    </div>
</div>

<div id="selection-info" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 10001;
    display: none;
    justify-content: center;
    align-items: center;
" onclick="this.style.display='none'">
    <div style="
        background: white;
        padding: 30px;
        border-radius: 16px;
        max-width: 500px;
        margin: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    " onclick="event.stopPropagation()">
        <h2 style="margin: 0 0 15px; color: #333;">ğŸ† í•´ì»¤í†¤ ì„ ì • ì´ìœ </h2>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <strong style="color: #667eea;">ì¬ë¬´/ìê¸ˆ</strong>
            <p style="margin: 10px 0 0; color: #555; line-height: 1.6;">ìê¸ˆ ê´€ë¦¬ ì–‘ì‹ - ì¬ë¬´ ë„ë©”ì¸</p>
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            
        </div>
        <button onclick="document.getElementById('selection-info').style.display='none'"
                style="margin-top: 20px; width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
            ë‹«ê¸°
        </button>
    </div>
</div>

<style>
body { padding-top: 56px !important; }
</style>
</body>
</html>
