<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>종합소득세 간이 계산기</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }
        .app-container { max-width: 1000px; margin: 0 auto; }
        .card { border: none; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
        .card-header { background: white; border-radius: 16px 16px 0 0 !important; }
        .result-highlight { background: #11998e; color: white; padding: 1.5rem; border-radius: 12px; }
        .tax-bracket { font-size: 0.85rem; }
        @media print { body { background: white !important; } .no-print { display: none !important; } }
    </style>
</head>
<body>
    <div class="app-container" x-data="taxCalculator()">
        <div class="text-center text-white mb-4">
            <h1 class="fw-bold">종합소득세 간이 계산기</h1>
            <p class="opacity-75">연간 소득을 입력하면 예상 세금을 계산합니다</p>
        </div>

        <div class="row g-4">
            <div class="col-lg-5">
                <div class="card">
                    <div class="card-header p-4">
                        <h5 class="mb-0">소득 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">연간 총 소득 (원)</label>
                            <div class="input-group">
                                <input type="text" class="form-control form-control-lg"
                                       x-model="incomeFormatted"
                                       @input="updateIncome($event)"
                                       placeholder="50,000,000">
                                <span class="input-group-text">원</span>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">기본 공제 (원)</label>
                            <div class="input-group">
                                <input type="text" class="form-control"
                                       x-model="deductionFormatted"
                                       @input="updateDeduction($event)"
                                       placeholder="1,500,000">
                                <span class="input-group-text">원</span>
                            </div>
                            <small class="text-muted">기본공제 150만원 (본인)</small>
                        </div>

                        <button class="btn btn-success btn-lg w-100 no-print" @click="calculate()">
                            세금 계산하기
                        </button>
                    </div>
                </div>

                <!-- 세율 안내 -->
                <div class="card mt-3">
                    <div class="card-body tax-bracket">
                        <h6 class="mb-3">2024년 종합소득세율</h6>
                        <table class="table table-sm mb-0">
                            <thead><tr><th>과세표준</th><th>세율</th></tr></thead>
                            <tbody>
                                <tr><td>1,400만원 이하</td><td>6%</td></tr>
                                <tr><td>5,000만원 이하</td><td>15%</td></tr>
                                <tr><td>8,800만원 이하</td><td>24%</td></tr>
                                <tr><td>1.5억원 이하</td><td>35%</td></tr>
                                <tr><td>3억원 이하</td><td>38%</td></tr>
                                <tr><td>5억원 이하</td><td>40%</td></tr>
                                <tr><td>10억원 이하</td><td>42%</td></tr>
                                <tr><td>10억원 초과</td><td>45%</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="col-lg-7">
                <div class="card">
                    <div class="card-header p-4 d-flex justify-content-between">
                        <h5 class="mb-0">계산 결과</h5>
                        <button class="btn btn-sm btn-outline-success no-print" @click="window.print()">인쇄</button>
                    </div>
                    <div class="card-body">
                        <div class="row g-3 mb-4">
                            <div class="col-6">
                                <div class="p-3 bg-light rounded">
                                    <small class="text-muted">총 소득</small>
                                    <div class="fs-5 fw-bold" x-text="formatCurrency(income)"></div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-3 bg-light rounded">
                                    <small class="text-muted">과세표준</small>
                                    <div class="fs-5 fw-bold" x-text="formatCurrency(taxableIncome)"></div>
                                </div>
                            </div>
                        </div>

                        <div class="result-highlight text-center mb-4">
                            <small class="opacity-75">예상 종합소득세</small>
                            <div class="fs-2 fw-bold" x-text="formatCurrency(calculatedTax)"></div>
                            <small class="opacity-75">적용 최고세율: <span x-text="maxRate"></span>%</small>
                        </div>

                        <div class="row g-3">
                            <div class="col-6">
                                <div class="p-3 border rounded">
                                    <small class="text-muted">지방소득세 (10%)</small>
                                    <div class="fs-5 fw-bold" x-text="formatCurrency(localTax)"></div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-3 border rounded">
                                    <small class="text-muted">총 납부세액</small>
                                    <div class="fs-5 fw-bold text-danger" x-text="formatCurrency(totalTax)"></div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 p-3 bg-success bg-opacity-10 rounded">
                            <div class="d-flex justify-content-between">
                                <span>세후 예상 소득</span>
                                <span class="fs-4 fw-bold text-success" x-text="formatCurrency(afterTaxIncome)"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center text-white-50 mt-4 small">
            원본: 종합소득세 엑셀 간이 계산기 v2.1.xlsx |
            <a href="../index.html" class="text-white">데모 목록으로</a>
        </footer>
    </div>

    <script>
        function taxCalculator() {
            return {
                income: 50000000,
                incomeFormatted: '50,000,000',
                deduction: 1500000,
                deductionFormatted: '1,500,000',
                taxableIncome: 0,
                calculatedTax: 0,
                localTax: 0,
                totalTax: 0,
                afterTaxIncome: 0,
                maxRate: 0,

                // 2024년 세율 구간
                brackets: [
                    { limit: 14000000, rate: 0.06, deduction: 0 },
                    { limit: 50000000, rate: 0.15, deduction: 1260000 },
                    { limit: 88000000, rate: 0.24, deduction: 5760000 },
                    { limit: 150000000, rate: 0.35, deduction: 15440000 },
                    { limit: 300000000, rate: 0.38, deduction: 19940000 },
                    { limit: 500000000, rate: 0.40, deduction: 25940000 },
                    { limit: 1000000000, rate: 0.42, deduction: 35940000 },
                    { limit: Infinity, rate: 0.45, deduction: 65940000 }
                ],

                init() { this.calculate(); },

                updateIncome(e) {
                    const val = e.target.value.replace(/[^\d]/g, '');
                    this.income = parseInt(val) || 0;
                    this.incomeFormatted = this.income.toLocaleString('ko-KR');
                    this.calculate();
                },

                updateDeduction(e) {
                    const val = e.target.value.replace(/[^\d]/g, '');
                    this.deduction = parseInt(val) || 0;
                    this.deductionFormatted = this.deduction.toLocaleString('ko-KR');
                    this.calculate();
                },

                calculate() {
                    this.taxableIncome = Math.max(0, this.income - this.deduction);

                    // 누진세 계산
                    let tax = 0;
                    for (const b of this.brackets) {
                        if (this.taxableIncome <= b.limit) {
                            tax = this.taxableIncome * b.rate - b.deduction;
                            this.maxRate = b.rate * 100;
                            break;
                        }
                    }
                    this.calculatedTax = Math.max(0, Math.round(tax));
                    this.localTax = Math.round(this.calculatedTax * 0.1);
                    this.totalTax = this.calculatedTax + this.localTax;
                    this.afterTaxIncome = this.income - this.totalTax;
                },

                formatCurrency(v) {
                    return new Intl.NumberFormat('ko-KR', {
                        style: 'currency', currency: 'KRW', maximumFractionDigits: 0
                    }).format(v);
                }
            };
        }
    </script>
</body>
</html>
